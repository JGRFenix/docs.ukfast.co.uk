# Buffer Overflow Attack

**What is a Buffer Overflow attack?**

The buffer overflow attack is a common attack on older systems, software and processes. This attack takes advantage of the way memory data blocks and buffers are allocated to system processes. A buffer overflow attack occurs when a system process tries to write data to a memory block or buffer when it is already full. This causes the data to be written to a memory address adjacent to the original destination buffer. This occurs when a program does not sufficiently manage its memory allocation, does not sufficiently implement bounds checking flags and discard data when too much is sent to a memory buffer.

Memory blocks are used to allocate a specific place in Memory (RAM) for an application to store information. During this process, the application will ask the operating system for memory resources, the operating system will then create a selection of memory (block) for that information to be stored. This is so the application/operating system can easily refer to that information when needed and to separate information from other applications.

To understand this further, we can use the following simplified example. Let's say you have a container that can hold a maximum of 8 cubes. If you then try to put 9 cubes in that container, the last cube is not going to fit, but, you need to put that remaining cube somewhere, so you need to overflow into the next container and place the remaining cube next container along. This container was not meant to hold this cube but due to the overflow, we have now unexpectedly added data to that container.

Attackers can utilize this to their advantage to get the computer to run malicious code. An attacker can send oversized payloads to a vulnerable application in an attempt to get it to write code to other memory blocks (containers). The payload can be specially crafted so that the overflowed data can be read by other applications, ran and then executed to allow the attacker access to the system.

**How can I remediate a buffer overflow vulnerability?**

As a buffer overflow is a low-level attack, happening at the memory level, it's difficult to remediate or prevent after the fact. Software developers must implement proper memory block bounds checking to check of the variable it's about to write to has enough space to hold the desired payload. 

As a system administrator, the best course of action would be to ensure that the latest software versions are used where possible and ensuring that any custom made software is created properly and tested vigorously.

**Rule(s) details**

```eval_rst
+---------+------------+----------------------------------------------------------------------+
| Rule ID | Rule Level | Rule Description                                                     |
+=========+============+======================================================================+
| 11219   | 12         | proftpd: FTP server Buffer overflow attempt.                         |
+---------+------------+----------------------------------------------------------------------+
| 30107   | 6          | Apache: Code Red attack.                                             |
+---------+------------+----------------------------------------------------------------------+
| 30307   | 6          | Apache: Client sent malformed Host header. Possible Code Red attack. |
+---------+------------+----------------------------------------------------------------------+
| 40102   | 14         | Buffer overflow attack on rpc.statd                                  |
+---------+------------+----------------------------------------------------------------------+
| 40103   | 14         | Buffer overflow on WU-FTPD versions prior to 2.6                     |
+---------+------------+----------------------------------------------------------------------+
| 40104   | 13         | Possible buffer overflow attempt.                                    |
+---------+------------+----------------------------------------------------------------------+
| 40106   | 12         | Buffer overflow attempt (probably on yppasswd).                      |
+---------+------------+----------------------------------------------------------------------+
```


```eval_rst
.. meta::
     :title: Buffer overflow attacks | UKFast Documentation
     :description: Threat Surveillance ruleset explained
     :keywords: threat surveillance, alerts, security, compliance, rules, rulesets, detection, hids, intrusion detection, buffer overfdlow, buffer, overflow, 11219, 30107, 30307, 40102, 40103, 40104, 40106

