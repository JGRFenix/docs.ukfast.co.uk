## Shellshock attack detected

**What is a Shellshock attack?**


A very common attack vector is a shellshock attack. Attacking the BASH (Bourne Again Shell) service on your server, this form of attack could allow an attacker to run arbitrary code on your server. This attack tries to get the target service to interpret the input as a BASH command which is then ran as if the command was input into a BASH shell. The BASH shell allows us to command and manage our server. Though here we can do things like creating users, set passwords, and control the operating system kernel. SSH (Secure Shell)works similar to a bash shell.

A common target for these types of attacks is a webserver service. An attacker will try to input BASH commands in a web request to try and get the webserver to interpret the URL as a bash command, and then run that in a bash style shell. This is one way that an attacker can get their malicious code to run on your server.

Let's look at the below example web server log.

"GET / HTTP/1.1" 200 3684 "() { _; OpenVAS; } >_[$($())] {  echo Content-Type: text/plain; echo; echo; PATH/usr/bin:/usr/local/bin:/bin; export PATH; id; }" "-"

Here we can see a shell attack, firstly, we can see that the server responded with a 200 code (successful), this means that the web server accepted this input. This does not necessarily mean that the attack was successful, but that the webserver has seen this as a valid web request and tried to find that page/function to the server to the user.

We can also see that the user agent on this occasion was OpenVAS, which is an Open Source vulnerability scanner. From this, we can determine that a vulnerability scanner was trying to see if this server was susceptible to a shell shock attack.

We can also see that the payload attack was trying to input BASH commands via the web service, we can see that this particular attack was trying to access the /bin and similar directories.

**How can I prevent this attack?**


We can prevent these attacks by ensuring that our web service and BASH is updated to the latest version with the latest security patches to allow the service to recognize the malicious input and drop it before any malicious code can run.

This rule also implements Dynamic Protection IP blocking, meaning that the attacking IP address will be blocked from accessing any content hosted on the server.

**Rule(s) details**

+---------+------------+-----------------------------------+
| Rule ID | Rule Level | Rule Description                  |
+=========+============+===================================+
| 31166   | 6          | Shellshock attack attempt         |
+---------+------------+-----------------------------------+
| 31166   | 6          | Shellshock attack detected        |
+---------+------------+-----------------------------------+
| 31167   | 6          | Shellshock attack attempt         |
+---------+------------+-----------------------------------+
| 31167   | 8          | Shellshock attack attempt         |
+---------+------------+-----------------------------------+
| 31168   | 15         | Shellshock attack detected        |
+---------+------------+-----------------------------------+
| 31168   | 8          | Shellshock attack detected        |
+---------+------------+-----------------------------------+
| 31169   | 15         | Shellshock attack detected        |
+---------+------------+-----------------------------------+
| 31169   | 8          | Shellshock attack detected        |
+---------+------------+-----------------------------------+
| 300215  | 6          | Apache: Shellshock attack attempt |
+---------+------------+-----------------------------------+
| 300216  | 6          | Apache: Shellshock attack attempt |
+---------+------------+-----------------------------------+


```eval_rst
.. meta::
     :title: Shellshock attacks | UKFast Documentation
     :description: Threat Surveillance ruleset explained
     :keywords: threat surveillance, alerts, security, compliance, rules, rulesets, detection, hids, intrusion detection, shellshock, shell shock

